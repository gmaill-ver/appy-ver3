<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>学習トラッカー - 行政書士試験対策</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- ヘッダー -->
    <header class="app-header">
        <button class="timer-icon-btn" onclick="TimerModule.openModal()" title="タイマー">
            ⏰
        </button>
        <div class="timer-display" id="timerDisplay">00:00:00</div>
        <div class="app-logo">
            <span class="app-logo-icon">📚</span>
            <span class="app-title">学習トラッカー</span>
        </div>
        <div class="exam-countdown" id="examCountdown">
            試験日まで <span class="days">--</span> 日
        </div>
    </header>
    
    <!-- メインタブ（3つ） -->
    <div class="main-tabs">
        <button class="main-tab active" onclick="App.switchMainTab('record', event)">記録入力</button>
        <button class="main-tab" onclick="App.switchMainTab('analysis', event)">分析</button>
        <button class="main-tab" onclick="App.switchMainTab('progress', event)">進捗</button>
    </div>
    
    <!-- コンテンツエリア -->
    <div class="content-area">
        <!-- 記録入力タブ -->
        <div id="record-tab" class="tab-content active">
            <!-- 問題集選択（開閉式カード） -->
            <div class="book-cards-wrapper">
                <button class="book-order-btn" onclick="UIComponents.toggleBookSort()">並替え</button>
                <div id="bookCardsContainer"></div>
            </div>
            
            <!-- パンくずリスト -->
            <div class="breadcrumb" id="breadcrumb" style="display: none;"></div>
            
            <!-- 階層リスト（記録用） -->
            <div id="recordHierarchyContainer" style="display: none;"></div>
            
            <!-- 問題入力 -->
            <div class="card" id="questionSection" style="display: none;">
                <div class="card-header">
                    <span class="card-icon">✍️</span>
                    <span class="card-title">問題別正誤入力</span>
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn correct" onclick="App.markCorrect()">
                        <span>⭕</span>
                        <span>正解</span>
                    </button>
                    <button class="action-btn wrong" onclick="App.markWrong()">
                        <span>❌</span>
                        <span>不正解</span>
                    </button>
                    <button class="action-btn bookmark" id="bookmarkBtn" onclick="App.toggleBookmarkMode()">
                        <span>⭐</span>
                        <span>マーク</span>
                    </button>
                </div>
                
                <div class="question-grid" id="questionGrid"></div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalCount">0</div>
                        <div class="stat-label">解答数</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="correctCount">0</div>
                        <div class="stat-label">正解数</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="wrongCount">0</div>
                        <div class="stat-label">不正解数</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="correctRate">0%</div>
                        <div class="stat-label">正答率</div>
                    </div>
                </div>
                
                <button class="save-button" onclick="App.saveRecord()">学習記録を保存</button>
            </div>
            
            <!-- カレンダー（最下部） -->
            <div class="calendar-container">
                <div class="calendar-header">
                    <div class="calendar-nav">
                        <button class="calendar-nav-btn" onclick="UIComponents.changeMonth(-1)">◀</button>
                        <span class="calendar-month" id="calendarMonth">2025年1月</span>
                        <button class="calendar-nav-btn" onclick="UIComponents.changeMonth(1)">▶</button>
                    </div>
                    <button class="calendar-nav-btn" onclick="UIComponents.goToToday()">今日</button>
                </div>
                <div class="calendar-grid" id="calendarGrid"></div>
                <div class="calendar-actions">
                    <button class="calendar-btn add-plan" onclick="UIComponents.openPlanModal()">📝 学習計画を追加</button>
                    <button class="calendar-btn view-plans" onclick="UIComponents.viewPlans()">📋 計画一覧</button>
                </div>
            </div>
        </div>
        
        <!-- 分析タブ -->
        <div id="analysis-tab" class="tab-content">
            <button class="card-sort-btn" onclick="Analytics.toggleAnalysisSort()">並替え</button>
            <div id="analysisCardsContainer">
                <!-- 学習グラフ -->
                <div class="accordion card" data-card-id="chart">
                    <div class="accordion-header" onclick="UIComponents.toggleAccordion(this)">
                        <span>📊 学習グラフ</span>
                        <span class="accordion-arrow">▼</span>
                    </div>
                    <div class="accordion-content">
                        <div class="chart-controls">
                            <button class="chart-btn active" onclick="Analytics.switchChartView('day', this)">日別</button>
                            <button class="chart-btn" onclick="Analytics.switchChartView('week', this)">週間</button>
                            <button class="chart-btn" onclick="Analytics.switchChartView('month', this)">月間</button>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-bars" id="chartBars"></div>
                        </div>
                    </div>
                </div>
                
                <!-- 学習履歴 -->
                <div class="accordion card" data-card-id="history">
                    <div class="accordion-header" onclick="UIComponents.toggleAccordion(this)">
                        <span>📅 学習履歴</span>
                        <span class="accordion-arrow">▼</span>
                    </div>
                    <div class="accordion-content">
                        <div id="historyContent"></div>
                    </div>
                </div>
                
                <!-- ヒートマップ -->
                <div class="accordion card" data-card-id="heatmap">
                    <div class="accordion-header" onclick="UIComponents.toggleAccordion(this)">
                        <span>🗺️ 問題ヒートマップ</span>
                        <span class="accordion-arrow">▼</span>
                    </div>
                    <div class="accordion-content">
                        <div class="heatmap-controls">
                            <select class="heatmap-select" id="heatmapBookSelect" onchange="Analytics.updateHeatmap()">
                                <option value="">問題集を選択</option>
                            </select>
                            <button class="heatmap-toggle-btn" id="heatmapToggleBtn" onclick="Analytics.toggleHeatmapPinned()">📌 固定</button>
                        </div>
                        <div class="heatmap-grid" id="heatmapGrid"></div>
                    </div>
                </div>
                
                <!-- 弱点分析 -->
                <div class="accordion card" data-card-id="weakness">
                    <div class="accordion-header" onclick="UIComponents.toggleAccordion(this)">
                        <span>🎯 弱点分析</span>
                        <span class="accordion-arrow">▼</span>
                    </div>
                    <div class="accordion-content">
                        <div id="weaknessAnalysis"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 進捗タブ -->
        <div id="progress-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">📊</span>
                    <span class="card-title">全体進捗状況</span>
                </div>
                <div id="overallProgress"></div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">📈</span>
                    <span class="card-title">科目別進捗</span>
                </div>
                <div class="radar-chart-container">
                    <div class="radar-chart-controls">
                        <select class="radar-chart-select" id="radarBookSelect" onchange="Analytics.drawRadarChart()">
                            <option value="">問題集を選択</option>
                        </select>
                        <button class="radar-toggle-btn" id="radarToggleBtn" onclick="Analytics.toggleRadarPinned()">📌 固定表示</button>
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <button class="chart-btn active" id="radarModeSubject" onclick="Analytics.setRadarMode('subject', this)">科目別</button>
                            <button class="chart-btn" id="radarModeCompare" onclick="Analytics.setRadarMode('compare', this)">問題集比較</button>
                        </div>
                    </div>
                    <canvas id="radarChart" width="300" height="300"></canvas>
                </div>
            </div>
        </div>
    </div>
    
    <!-- フッタータブ -->
    <div class="footer-tabs">
        <button class="footer-tab active" onclick="App.switchFooterTab('register', event)">
            <span class="footer-tab-icon">📝</span>
            <span class="footer-tab-label">登録</span>
        </button>
        <button class="footer-tab" onclick="App.switchFooterTab('qa', event)">
            <span class="footer-tab-icon">❓</span>
            <span class="footer-tab-label">一問一答</span>
        </button>
        <button class="footer-tab" onclick="App.switchFooterTab('results', event)">
            <span class="footer-tab-icon">🏆</span>
            <span class="footer-tab-label">実績</span>
        </button>
        <button class="footer-tab" onclick="App.switchFooterTab('settings', event)">
            <span class="footer-tab-icon">⚙️</span>
            <span class="footer-tab-label">設定</span>
        </button>
    </div>
    
    <!-- タイマーモーダル -->
    <div id="timerModal" class="timer-modal"></div>
    
    <!-- 学習計画モーダル -->
    <div id="planModal" class="plan-modal"></div>
    
    <!-- フッタータブコンテンツ（モーダル表示） -->
    <div id="footerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">タイトル</h3>
                <button class="modal-close" onclick="App.closeFooterModal()">×</button>
            </div>
            <div id="modalBody"></div>
        </div>
        <div class="modal-footer">
            <button class="modal-close-bottom" onclick="App.closeFooterModal()">閉じる</button>
        </div>
    </div>
    
    <!-- 入力ダイアログ -->
    <div id="dialogOverlay" class="dialog-overlay" style="display: none;"></div>
    <div id="inputDialog" class="input-dialog" style="display: none;">
        <h3 id="dialogTitle">タイトル</h3>
        <div id="dialogBody"></div>
        <div class="dialog-buttons">
            <button class="dialog-btn secondary" onclick="UIComponents.closeDialog()">キャンセル</button>
            <button class="dialog-btn primary" id="dialogConfirmBtn">確定</button>
        </div>
    </div>
    
    <!-- JavaScriptファイル読み込み -->
    <script src="data-manager.js"></script>
    <script src="ui-components.js"></script>
    <script src="analytics.js"></script>
    <script src="qa-module.js"></script>
    <script src="app.js"></script>
</body>
</html>
